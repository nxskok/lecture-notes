{
  "hash": "59316275288df5e6f3cbc8e9401a807a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Basic statistical inference\"\n---\n\n\n\n\n## Packages for this section\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\n\n\n## Inference for means (from STAB57)\n\nThree kinds of inference for means of normally-distributed data:\n\n- **One-sample $t$**: a single sample from a population, estimate that population's mean\n- **Two-sample $t$**: one sample from each of 2 populations, estimate difference in population means\n- **Matched pairs $t$**: two paired measurements on same (or matched) individuals, estimate population mean difference\n\nTwo forms of inference for a population parameter:\n \n- **Confidence interval**: \"what is the population parameter?\"\n- **Hypothesis test**: \"could the population parameter be equal to this value?\"\n\n\n## Examples:\n\n- Blue jays attendances (one-sample)\n- Kids learning to read (two-sample)\n- Pain relief (matched pairs)\n\n## Confidence interval\n\n- You have a sample from some population\n- Imagine repeated sampling from that population\n- Procedure that gives an interval containing the true parameter in 95% (or 90% or 99%) of all possible samples\n\n## Hypothesis test\n\n- Null hypothesis gives value for population parameter\n- Alternative hypothesis says how you are trying to prove the null hypothesis wrong (not equal, greater, less).\n- Test statistic measures \"distance\" between data and null hypothesis\n- P-value gives probability of observing test statistic *as extreme or more extreme*, **if the null hypothesis is true**.\n- Reject null hypothesis if P-value small enough (eg smaller than 0.05).\n\n## Why 0.05? This man.\n\n::: columns\n::: {.column width=\"40%\"}\n![](fisher.png)\n:::\n\n::: {.column width=\"60%\"}\n-   analysis of variance\n-   Fisher information\n-   Linear discriminant analysis\n-   Fisher's $z$-transformation\n-   Fisher-Yates shuffle\n-   Behrens-Fisher problem\n\nSir Ronald A. Fisher, 1890--1962.\n:::\n:::\n\n## Why 0.05? (2)\n\n-   From The Arrangement of Field Experiments (1926):\n\n![](fisher1.png){width=\"100%\"}\n\n-   and\n\n![](fisher2.png){width=\"100%\"}\n\n## $\\alpha$ and errors\n\n-   Hypothesis test ends with decision:\n    -   reject null hypothesis\n    -   do not reject null hypothesis.\n-   but decision may be wrong:\n\n|                | Decision          |                 |\n|----------------|-------------------|-----------------|\n| **Truth**      | **Do not reject** | **reject null** |\n| **Null true**  | Correct           | Type I error    |\n| **Null false** | Type II error     | Correct         |\n\n-   Either type of error is bad, but for now focus on controlling Type I\n    error: write $\\alpha$ = P(type I error), and devise test so that\n    $\\alpha$ small, typically 0.05.\n-   That is, **if null hypothesis true**, have only small chance to\n    reject it (which would be a mistake).\n-   Worry about type II errors later (when we consider power of test).\n\n\n\n## One sample: the Blue Jays attendances\n\n\n-   The Toronto Blue Jays' average home attendance in part of 2015\n    season was 25,070 (up to May 27 2015, from baseball-reference.com).\n-   Does that mean the attendance at every game was exactly 25,070?\n    Certainly not. Actual attendance depends on many things, eg.:\n    -   how well the Jays are playing\n    -   the opposition\n    -   day of week\n    -   weather\n    -   random chance\n\n\n## Reading the attendances\n\n...as a `.csv` file:\n\n\\footnotesize\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/jays15-home.csv\"\njays <- read_csv(my_url) \njays\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"row\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"game\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"date\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"box\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"team\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"venue\"],\"name\":[6],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"opp\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"result\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"runs\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Oppruns\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"innings\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"wl\"],\"name\":[12],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"position\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"gb\"],\"name\":[14],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"winner\"],\"name\":[15],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"loser\"],\"name\":[16],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"save\"],\"name\":[17],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"game time\"],\"name\":[18],\"type\":[\"time\"],\"align\":[\"right\"]},{\"label\":[\"Daynight\"],\"name\":[19],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"attendance\"],\"name\":[20],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"streak\"],\"name\":[21],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"82\",\"2\":\"7\",\"3\":\"Monday, Apr 13\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"TBR\",\"8\":\"L\",\"9\":\"1\",\"10\":\"2\",\"11\":\"NA\",\"12\":\"4-3\",\"13\":\"2\",\"14\":\"1\",\"15\":\"Odorizzi\",\"16\":\"Dickey\",\"17\":\"Boxberger\",\"18\":\"02:30:00\",\"19\":\"N\",\"20\":\"48414\",\"21\":\"-\"},{\"1\":\"83\",\"2\":\"8\",\"3\":\"Tuesday, Apr 14\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"TBR\",\"8\":\"L\",\"9\":\"2\",\"10\":\"3\",\"11\":\"NA\",\"12\":\"4-4\",\"13\":\"3\",\"14\":\"2\",\"15\":\"Geltz\",\"16\":\"Castro\",\"17\":\"Jepsen\",\"18\":\"03:06:00\",\"19\":\"N\",\"20\":\"17264\",\"21\":\"--\"},{\"1\":\"84\",\"2\":\"9\",\"3\":\"Wednesday, Apr 15\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"TBR\",\"8\":\"W\",\"9\":\"12\",\"10\":\"7\",\"11\":\"NA\",\"12\":\"5-4\",\"13\":\"2\",\"14\":\"1\",\"15\":\"Buehrle\",\"16\":\"Ramirez\",\"17\":\"NA\",\"18\":\"03:02:00\",\"19\":\"N\",\"20\":\"15086\",\"21\":\"+\"},{\"1\":\"85\",\"2\":\"10\",\"3\":\"Thursday, Apr 16\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"TBR\",\"8\":\"L\",\"9\":\"2\",\"10\":\"4\",\"11\":\"NA\",\"12\":\"5-5\",\"13\":\"4\",\"14\":\"1.5\",\"15\":\"Archer\",\"16\":\"Sanchez\",\"17\":\"Boxberger\",\"18\":\"03:00:00\",\"19\":\"N\",\"20\":\"14433\",\"21\":\"-\"},{\"1\":\"86\",\"2\":\"11\",\"3\":\"Friday, Apr 17\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"ATL\",\"8\":\"L\",\"9\":\"7\",\"10\":\"8\",\"11\":\"NA\",\"12\":\"5-6\",\"13\":\"4\",\"14\":\"2.5\",\"15\":\"Martin\",\"16\":\"Cecil\",\"17\":\"Grilli\",\"18\":\"03:09:00\",\"19\":\"N\",\"20\":\"21397\",\"21\":\"--\"},{\"1\":\"87\",\"2\":\"12\",\"3\":\"Saturday, Apr 18\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"ATL\",\"8\":\"W-wo\",\"9\":\"6\",\"10\":\"5\",\"11\":\"10\",\"12\":\"6-6\",\"13\":\"3\",\"14\":\"1.5\",\"15\":\"Cecil\",\"16\":\"Marimon\",\"17\":\"NA\",\"18\":\"02:41:00\",\"19\":\"D\",\"20\":\"34743\",\"21\":\"+\"},{\"1\":\"88\",\"2\":\"13\",\"3\":\"Sunday, Apr 19\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"ATL\",\"8\":\"L\",\"9\":\"2\",\"10\":\"5\",\"11\":\"NA\",\"12\":\"6-7\",\"13\":\"4\",\"14\":\"1.5\",\"15\":\"Miller\",\"16\":\"Norris\",\"17\":\"Grilli\",\"18\":\"02:41:00\",\"19\":\"D\",\"20\":\"44794\",\"21\":\"-\"},{\"1\":\"89\",\"2\":\"14\",\"3\":\"Tuesday, Apr 21\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"BAL\",\"8\":\"W\",\"9\":\"13\",\"10\":\"6\",\"11\":\"NA\",\"12\":\"7-7\",\"13\":\"2\",\"14\":\"2\",\"15\":\"Buehrle\",\"16\":\"Norris\",\"17\":\"NA\",\"18\":\"02:53:00\",\"19\":\"N\",\"20\":\"14184\",\"21\":\"+\"},{\"1\":\"90\",\"2\":\"15\",\"3\":\"Wednesday, Apr 22\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"BAL\",\"8\":\"W\",\"9\":\"4\",\"10\":\"2\",\"11\":\"NA\",\"12\":\"8-7\",\"13\":\"2\",\"14\":\"1\",\"15\":\"Sanchez\",\"16\":\"Jimenez\",\"17\":\"Castro\",\"18\":\"02:36:00\",\"19\":\"N\",\"20\":\"15606\",\"21\":\"++\"},{\"1\":\"91\",\"2\":\"16\",\"3\":\"Thursday, Apr 23\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"BAL\",\"8\":\"W\",\"9\":\"7\",\"10\":\"6\",\"11\":\"NA\",\"12\":\"9-7\",\"13\":\"1\",\"14\":\"Tied\",\"15\":\"Hutchison\",\"16\":\"Tillman\",\"17\":\"Castro\",\"18\":\"02:36:00\",\"19\":\"N\",\"20\":\"18581\",\"21\":\"+++\"},{\"1\":\"92\",\"2\":\"27\",\"3\":\"Monday, May 4\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"NYY\",\"8\":\"W\",\"9\":\"3\",\"10\":\"1\",\"11\":\"NA\",\"12\":\"13-14\",\"13\":\"4\",\"14\":\"3.5\",\"15\":\"Dickey\",\"16\":\"Martin\",\"17\":\"Cecil\",\"18\":\"02:18:00\",\"19\":\"N\",\"20\":\"19217\",\"21\":\"+\"},{\"1\":\"93\",\"2\":\"28\",\"3\":\"Tuesday, May 5\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"NYY\",\"8\":\"L\",\"9\":\"3\",\"10\":\"6\",\"11\":\"NA\",\"12\":\"13-15\",\"13\":\"5\",\"14\":\"4.5\",\"15\":\"Pineda\",\"16\":\"Estrada\",\"17\":\"Miller\",\"18\":\"02:54:00\",\"19\":\"N\",\"20\":\"21519\",\"21\":\"-\"},{\"1\":\"94\",\"2\":\"29\",\"3\":\"Wednesday, May 6\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"NYY\",\"8\":\"W\",\"9\":\"5\",\"10\":\"1\",\"11\":\"NA\",\"12\":\"14-15\",\"13\":\"3\",\"14\":\"3.5\",\"15\":\"Buehrle\",\"16\":\"Sabathia\",\"17\":\"NA\",\"18\":\"02:30:00\",\"19\":\"N\",\"20\":\"21312\",\"21\":\"+\"},{\"1\":\"95\",\"2\":\"30\",\"3\":\"Friday, May 8\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"BOS\",\"8\":\"W\",\"9\":\"7\",\"10\":\"0\",\"11\":\"NA\",\"12\":\"15-15\",\"13\":\"3\",\"14\":\"4\",\"15\":\"Sanchez\",\"16\":\"Miley\",\"17\":\"NA\",\"18\":\"02:41:00\",\"19\":\"N\",\"20\":\"30430\",\"21\":\"++\"},{\"1\":\"96\",\"2\":\"31\",\"3\":\"Saturday, May 9\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"BOS\",\"8\":\"W\",\"9\":\"7\",\"10\":\"1\",\"11\":\"NA\",\"12\":\"16-15\",\"13\":\"3\",\"14\":\"3\",\"15\":\"Hutchison\",\"16\":\"Kelly\",\"17\":\"NA\",\"18\":\"03:12:00\",\"19\":\"D\",\"20\":\"42917\",\"21\":\"+++\"},{\"1\":\"97\",\"2\":\"32\",\"3\":\"Sunday, May 10\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"BOS\",\"8\":\"L\",\"9\":\"3\",\"10\":\"6\",\"11\":\"NA\",\"12\":\"16-16\",\"13\":\"3\",\"14\":\"4\",\"15\":\"Buchholz\",\"16\":\"Dickey\",\"17\":\"Uehara\",\"18\":\"02:38:00\",\"19\":\"D\",\"20\":\"42419\",\"21\":\"-\"},{\"1\":\"98\",\"2\":\"40\",\"3\":\"Monday, May 18\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"LAA\",\"8\":\"W\",\"9\":\"10\",\"10\":\"6\",\"11\":\"NA\",\"12\":\"18-22\",\"13\":\"5\",\"14\":\"4.5\",\"15\":\"Osuna\",\"16\":\"Morin\",\"17\":\"NA\",\"18\":\"03:28:00\",\"19\":\"D\",\"20\":\"29306\",\"21\":\"+\"},{\"1\":\"99\",\"2\":\"41\",\"3\":\"Tuesday, May 19\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"LAA\",\"8\":\"L\",\"9\":\"2\",\"10\":\"3\",\"11\":\"NA\",\"12\":\"18-23\",\"13\":\"5\",\"14\":\"4.5\",\"15\":\"Santiago\",\"16\":\"Sanchez\",\"17\":\"Street\",\"18\":\"02:32:00\",\"19\":\"N\",\"20\":\"15062\",\"21\":\"-\"},{\"1\":\"100\",\"2\":\"42\",\"3\":\"Wednesday, May 20\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"LAA\",\"8\":\"L\",\"9\":\"3\",\"10\":\"4\",\"11\":\"NA\",\"12\":\"18-24\",\"13\":\"5\",\"14\":\"4.5\",\"15\":\"Weaver\",\"16\":\"Hutchison\",\"17\":\"Street\",\"18\":\"02:36:00\",\"19\":\"N\",\"20\":\"16402\",\"21\":\"--\"},{\"1\":\"101\",\"2\":\"43\",\"3\":\"Thursday, May 21\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"LAA\",\"8\":\"W\",\"9\":\"8\",\"10\":\"4\",\"11\":\"NA\",\"12\":\"19-24\",\"13\":\"5\",\"14\":\"4.5\",\"15\":\"Dickey\",\"16\":\"Shoemaker\",\"17\":\"NA\",\"18\":\"02:22:00\",\"19\":\"N\",\"20\":\"19014\",\"21\":\"+\"},{\"1\":\"102\",\"2\":\"44\",\"3\":\"Friday, May 22\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"SEA\",\"8\":\"L\",\"9\":\"3\",\"10\":\"4\",\"11\":\"NA\",\"12\":\"19-25\",\"13\":\"5\",\"14\":\"5.5\",\"15\":\"Hernandez\",\"16\":\"Estrada\",\"17\":\"Rodney\",\"18\":\"02:30:00\",\"19\":\"N\",\"20\":\"21195\",\"21\":\"-\"},{\"1\":\"103\",\"2\":\"45\",\"3\":\"Saturday, May 23\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"SEA\",\"8\":\"L\",\"9\":\"2\",\"10\":\"3\",\"11\":\"NA\",\"12\":\"19-26\",\"13\":\"5\",\"14\":\"5.5\",\"15\":\"Paxton\",\"16\":\"Buehrle\",\"17\":\"Rodney\",\"18\":\"02:25:00\",\"19\":\"D\",\"20\":\"33086\",\"21\":\"--\"},{\"1\":\"104\",\"2\":\"46\",\"3\":\"Sunday, May 24\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"SEA\",\"8\":\"W\",\"9\":\"8\",\"10\":\"2\",\"11\":\"NA\",\"12\":\"20-26\",\"13\":\"5\",\"14\":\"4.5\",\"15\":\"Sanchez\",\"16\":\"Walker\",\"17\":\"NA\",\"18\":\"02:50:00\",\"19\":\"D\",\"20\":\"37929\",\"21\":\"+\"},{\"1\":\"105\",\"2\":\"47\",\"3\":\"Monday, May 25\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"CHW\",\"8\":\"W\",\"9\":\"6\",\"10\":\"0\",\"11\":\"NA\",\"12\":\"21-26\",\"13\":\"5\",\"14\":\"3.5\",\"15\":\"Hutchison\",\"16\":\"Noesi\",\"17\":\"NA\",\"18\":\"02:10:00\",\"19\":\"N\",\"20\":\"15168\",\"21\":\"++\"},{\"1\":\"106\",\"2\":\"48\",\"3\":\"Tuesday, May 26\",\"4\":\"boxscore\",\"5\":\"TOR\",\"6\":\"NA\",\"7\":\"CHW\",\"8\":\"W-wo\",\"9\":\"10\",\"10\":\"9\",\"11\":\"NA\",\"12\":\"22-26\",\"13\":\"4\",\"14\":\"3\",\"15\":\"Delabar\",\"16\":\"Robertson\",\"17\":\"NA\",\"18\":\"03:12:00\",\"19\":\"N\",\"20\":\"17276\",\"21\":\"+++\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\\normalsize\n\n## Another way\n\n-   This is a \"big\" data set: only 25 observations, but a lot of\n    *variables*.\n\n-   To see the first few values in all the variables, can also use\n    `glimpse`:\n\n\\scriptsize\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(jays)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 25\nColumns: 21\n$ row         <dbl> 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96…\n$ game        <dbl> 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 27, 28, 29, 30, 31, 3…\n$ date        <chr> \"Monday, Apr 13\", \"Tuesday, Apr 14\", \"Wednesday, Apr 15\", …\n$ box         <chr> \"boxscore\", \"boxscore\", \"boxscore\", \"boxscore\", \"boxscore\"…\n$ team        <chr> \"TOR\", \"TOR\", \"TOR\", \"TOR\", \"TOR\", \"TOR\", \"TOR\", \"TOR\", \"T…\n$ venue       <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ opp         <chr> \"TBR\", \"TBR\", \"TBR\", \"TBR\", \"ATL\", \"ATL\", \"ATL\", \"BAL\", \"B…\n$ result      <chr> \"L\", \"L\", \"W\", \"L\", \"L\", \"W-wo\", \"L\", \"W\", \"W\", \"W\", \"W\", …\n$ runs        <dbl> 1, 2, 12, 2, 7, 6, 2, 13, 4, 7, 3, 3, 5, 7, 7, 3, 10, 2, 3…\n$ Oppruns     <dbl> 2, 3, 7, 4, 8, 5, 5, 6, 2, 6, 1, 6, 1, 0, 1, 6, 6, 3, 4, 4…\n$ innings     <dbl> NA, NA, NA, NA, NA, 10, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ wl          <chr> \"4-3\", \"4-4\", \"5-4\", \"5-5\", \"5-6\", \"6-6\", \"6-7\", \"7-7\", \"8…\n$ position    <dbl> 2, 3, 2, 4, 4, 3, 4, 2, 2, 1, 4, 5, 3, 3, 3, 3, 5, 5, 5, 5…\n$ gb          <chr> \"1\", \"2\", \"1\", \"1.5\", \"2.5\", \"1.5\", \"1.5\", \"2\", \"1\", \"Tied…\n$ winner      <chr> \"Odorizzi\", \"Geltz\", \"Buehrle\", \"Archer\", \"Martin\", \"Cecil…\n$ loser       <chr> \"Dickey\", \"Castro\", \"Ramirez\", \"Sanchez\", \"Cecil\", \"Marimo…\n$ save        <chr> \"Boxberger\", \"Jepsen\", NA, \"Boxberger\", \"Grilli\", NA, \"Gri…\n$ `game time` <time> 02:30:00, 03:06:00, 03:02:00, 03:00:00, 03:09:00, 02:41:0…\n$ Daynight    <chr> \"N\", \"N\", \"N\", \"N\", \"N\", \"D\", \"D\", \"N\", \"N\", \"N\", \"N\", \"N\"…\n$ attendance  <dbl> 48414, 17264, 15086, 14433, 21397, 34743, 44794, 14184, 15…\n$ streak      <chr> \"-\", \"--\", \"+\", \"-\", \"--\", \"+\", \"-\", \"+\", \"++\", \"+++\", \"+\"…\n```\n\n\n:::\n:::\n\n\n\n\n\\normalsize\n\n## Attendance histogram\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(jays, aes(x = attendance)) + geom_histogram(bins = 6)\n```\n\n::: {.cell-output-display}\n![](inference_c33_files/figure-revealjs/inference-1-R-6-1.png){width=960}\n:::\n:::\n\n\n\n\n## Comments\n\n-   Attendances have substantial variability, ranging from just over\n    10,000 to around 50,000.\n-   Distribution somewhat skewed to right (but no outliers).\n-   These are a sample of \"all possible games\" (or maybe \"all possible\n    games played in April and May\"). What can we say about mean\n    attendance in all possible games based on this evidence?\n\n## CI for mean attendance\n\n-   `t.test` function does CI and test. Look at CI first:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(jays$attendance)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne Sample t-test\n\ndata:  jays$attendance\nt = 11.389, df = 24, p-value = 3.661e-11\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 20526.82 29613.50\nsample estimates:\nmean of x \n 25070.16 \n```\n\n\n:::\n:::\n\n\n\n\n-   From 20,500 to 29,600.\n\n## Or, 90% CI\n\n-   by including a value for conf.level:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(jays$attendance, conf.level = 0.90)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne Sample t-test\n\ndata:  jays$attendance\nt = 11.389, df = 24, p-value = 3.661e-11\nalternative hypothesis: true mean is not equal to 0\n90 percent confidence interval:\n 21303.93 28836.39\nsample estimates:\nmean of x \n 25070.16 \n```\n\n\n:::\n:::\n\n\n\n\n-   From 21,300 to 28,800. (Shorter, as it should be.)\n\n## Comments\n\n-   Need to say \"column attendance within data frame `jays`\" using `$`.\n-   95% CI from about 20,000 to about 30,000.\n-   Not estimating mean attendance well at all!\n-   Generally want confidence interval to be shorter, which happens if:\n    -   SD smaller\n    -   sample size bigger\n    -   confidence level smaller\n-   Last one is a cheat, really, since reducing confidence level\n    increases chance that interval won't contain pop. mean at all!\n\n## Another way to access data frame columns\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(jays, t.test(attendance))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne Sample t-test\n\ndata:  attendance\nt = 11.389, df = 24, p-value = 3.661e-11\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 20526.82 29613.50\nsample estimates:\nmean of x \n 25070.16 \n```\n\n\n:::\n:::\n\n\n\n\n## Hypothesis testing for Blue Jays attendances\n\n\n- Previous year's mean attendance was 29,327, so test to see whether the mean is different from that in any way (two-sided test):\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(jays$attendance, mu = 29327)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne Sample t-test\n\ndata:  jays$attendance\nt = -1.9338, df = 24, p-value = 0.06502\nalternative hypothesis: true mean is not equal to 29327\n95 percent confidence interval:\n 20526.82 29613.50\nsample estimates:\nmean of x \n 25070.16 \n```\n\n\n:::\n:::\n\n\n\n\n-   See test statistic $-1.93$, P-value 0.065.\n-   Do not reject null at $\\alpha=0.05$: no evidence that mean\n    attendance has changed.\n\n## Another example: learning to read\n\n- You devised new method for teaching children to read.\n- Guess it will be more effective than current methods.\n- To support this guess, collect data.\n- Want to generalize to “all children in Canada”.\n- So take random sample of all children in Canada.\n- Or, argue that sample you actually have is “typical” of all children in\nCanada.\n- Randomization (1): whether or not a child in sample or not has\nnothing to do with anything else about that child.\n- Randomization (2): randomly choose whether each child gets new\nreading method (t) or standard one (c).\n\n## Reading in data \n- File at <http://ritsokiguess.site/datafiles/drp.txt>.\n- Proper reading-in function is `read_delim` (check file to see)\n- Read in thus:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/drp.txt\"\nkids <- read_delim(my_url,\" \")\n```\n:::\n\n\n\n\n## The data (some) \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkids\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"group\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"score\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"t\",\"2\":\"24\"},{\"1\":\"t\",\"2\":\"61\"},{\"1\":\"t\",\"2\":\"59\"},{\"1\":\"t\",\"2\":\"46\"},{\"1\":\"t\",\"2\":\"43\"},{\"1\":\"t\",\"2\":\"44\"},{\"1\":\"t\",\"2\":\"52\"},{\"1\":\"t\",\"2\":\"43\"},{\"1\":\"t\",\"2\":\"58\"},{\"1\":\"t\",\"2\":\"67\"},{\"1\":\"t\",\"2\":\"62\"},{\"1\":\"t\",\"2\":\"57\"},{\"1\":\"t\",\"2\":\"71\"},{\"1\":\"t\",\"2\":\"49\"},{\"1\":\"t\",\"2\":\"54\"},{\"1\":\"t\",\"2\":\"43\"},{\"1\":\"t\",\"2\":\"53\"},{\"1\":\"t\",\"2\":\"57\"},{\"1\":\"t\",\"2\":\"49\"},{\"1\":\"t\",\"2\":\"56\"},{\"1\":\"t\",\"2\":\"33\"},{\"1\":\"c\",\"2\":\"42\"},{\"1\":\"c\",\"2\":\"33\"},{\"1\":\"c\",\"2\":\"46\"},{\"1\":\"c\",\"2\":\"37\"},{\"1\":\"c\",\"2\":\"43\"},{\"1\":\"c\",\"2\":\"41\"},{\"1\":\"c\",\"2\":\"10\"},{\"1\":\"c\",\"2\":\"42\"},{\"1\":\"c\",\"2\":\"55\"},{\"1\":\"c\",\"2\":\"19\"},{\"1\":\"c\",\"2\":\"17\"},{\"1\":\"c\",\"2\":\"55\"},{\"1\":\"c\",\"2\":\"26\"},{\"1\":\"c\",\"2\":\"54\"},{\"1\":\"c\",\"2\":\"60\"},{\"1\":\"c\",\"2\":\"28\"},{\"1\":\"c\",\"2\":\"62\"},{\"1\":\"c\",\"2\":\"20\"},{\"1\":\"c\",\"2\":\"53\"},{\"1\":\"c\",\"2\":\"48\"},{\"1\":\"c\",\"2\":\"37\"},{\"1\":\"c\",\"2\":\"85\"},{\"1\":\"c\",\"2\":\"42\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n## Boxplots\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(kids, aes(x = group, y = score)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](inference_c33_files/figure-revealjs/inference-1-R-14-1.png){width=960}\n:::\n:::\n\n\n\n\n## Two kinds of two-sample t-test\n\n- Do the two groups have same spread (SD, variance)?\n    - If yes (shaky assumption here), can use pooled t-test.\n    - If not, use Welch-Satterthwaite t-test (safe).\n- Pooled test derived in STAB57 (easier to derive, but assumes equal variances).\n- Welch-Satterthwaite does not assume equality of variances.\n- Assess (approx) equality of spreads using boxplot.\n\n## The (Welch-Satterthwaite) t-test\n- `c` (control) before `t` (treatment) alphabetically, so proper alternative\nis “less”.\n- R does Welch-Satterthwaite test by default \n- Answer to \"does the new reading program really help?\"\n- (in a moment) how to get R to do pooled test?\n\n## Welch-Satterthwaite \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(score ~ group, data = kids, alternative = \"less\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  score by group\nt = -2.3109, df = 37.855, p-value = 0.01319\nalternative hypothesis: true difference in means between group c and group t is less than 0\n95 percent confidence interval:\n      -Inf -2.691293\nsample estimates:\nmean in group c mean in group t \n       41.52174        51.47619 \n```\n\n\n:::\n:::\n\n\n\n\n## The pooled t-test \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(score ~ group, data = kids, \n       alternative = \"less\", var.equal = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tTwo Sample t-test\n\ndata:  score by group\nt = -2.2666, df = 42, p-value = 0.01431\nalternative hypothesis: true difference in means between group c and group t is less than 0\n95 percent confidence interval:\n      -Inf -2.567497\nsample estimates:\nmean in group c mean in group t \n       41.52174        51.47619 \n```\n\n\n:::\n:::\n\n\n\n\n## Two-sided test; CI\n- To do 2-sided test, leave out `alternative`:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(score ~ group, data = kids)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  score by group\nt = -2.3109, df = 37.855, p-value = 0.02638\nalternative hypothesis: true difference in means between group c and group t is not equal to 0\n95 percent confidence interval:\n -18.67588  -1.23302\nsample estimates:\nmean in group c mean in group t \n       41.52174        51.47619 \n```\n\n\n:::\n:::\n\n\n\n\n\n## Comments:\n\n- P-values for pooled and Welch-Satterthwaite tests very similar (even though the pooled test seemed inferior): 0.013 vs.\\ 0.014.\n- Two-sided test also gives CI: new reading program increases average scores by\nsomewhere between about 1 and 19 points.\n- Confidence intervals inherently two-sided, so do 2-sided test to get\nthem.\n\n## Pain relief\n\nSome data: \n\n\\centering{\n  \\includegraphics[height=0.7\\textheight]{Screenshot_2019-04-26_13-41-29}\n}\n\n\n## Matched pairs data\n- Data are comparison of 2 drugs for effectiveness at reducing pain.\n\n     - 12 subjects (cases) were arthritis sufferers\n     - Response is #hours of pain relief from each drug.\n      \n- In reading example, each child tried only one reading method.\n- But here, each subject tried out both drugs, giving us two\nmeasurements.\n\n    - Possible because, if you wait long enough, one drug has no influence\nover effect of other.\n    - Advantage: focused comparison of drugs. Compare one drug with\nanother on same person, removes a lot of variability due to differences between people. \n    - Matched pairs, requires different analysis.\n      \n- Design: randomly choose 6 of 12 subjects to get drug A first, other 6\nget drug B first.\n\n## Paired t test: reading the data\nValues aligned in columns:  \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/analgesic.txt\"\npain <- read_table(my_url)\n```\n:::\n\n\n\n\n## The data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npain\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"subject\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"druga\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"drugb\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"2.0\",\"3\":\"3.5\"},{\"1\":\"2\",\"2\":\"3.6\",\"3\":\"5.7\"},{\"1\":\"3\",\"2\":\"2.6\",\"3\":\"2.9\"},{\"1\":\"4\",\"2\":\"2.6\",\"3\":\"2.4\"},{\"1\":\"5\",\"2\":\"7.3\",\"3\":\"9.9\"},{\"1\":\"6\",\"2\":\"3.4\",\"3\":\"3.3\"},{\"1\":\"7\",\"2\":\"14.9\",\"3\":\"16.7\"},{\"1\":\"8\",\"2\":\"6.6\",\"3\":\"6.0\"},{\"1\":\"9\",\"2\":\"2.3\",\"3\":\"3.8\"},{\"1\":\"10\",\"2\":\"2.0\",\"3\":\"4.0\"},{\"1\":\"11\",\"2\":\"6.8\",\"3\":\"9.1\"},{\"1\":\"12\",\"2\":\"8.5\",\"3\":\"20.9\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n## Paired *t*-test \n\n\\small\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(pain, t.test(druga, drugb, paired = T))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPaired t-test\n\ndata:  druga and drugb\nt = -2.1677, df = 11, p-value = 0.05299\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n -4.29941513  0.03274847\nsample estimates:\nmean difference \n      -2.133333 \n```\n\n\n:::\n:::\n\n\n\n\n\\normalsize\n\n- P-value is 0.053. \n- Not quite evidence of difference between drugs.\n\n## t-testing the differences\n\n- Likewise, you can calculate the differences yourself and\ndo a 1-sample t-test on them.\n- First calculate a column of differences:\n\n\\footnotesize\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(pain %>% mutate(diff=druga-drugb) -> pain)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"subject\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"druga\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"drugb\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"diff\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"2.0\",\"3\":\"3.5\",\"4\":\"-1.5\"},{\"1\":\"2\",\"2\":\"3.6\",\"3\":\"5.7\",\"4\":\"-2.1\"},{\"1\":\"3\",\"2\":\"2.6\",\"3\":\"2.9\",\"4\":\"-0.3\"},{\"1\":\"4\",\"2\":\"2.6\",\"3\":\"2.4\",\"4\":\"0.2\"},{\"1\":\"5\",\"2\":\"7.3\",\"3\":\"9.9\",\"4\":\"-2.6\"},{\"1\":\"6\",\"2\":\"3.4\",\"3\":\"3.3\",\"4\":\"0.1\"},{\"1\":\"7\",\"2\":\"14.9\",\"3\":\"16.7\",\"4\":\"-1.8\"},{\"1\":\"8\",\"2\":\"6.6\",\"3\":\"6.0\",\"4\":\"0.6\"},{\"1\":\"9\",\"2\":\"2.3\",\"3\":\"3.8\",\"4\":\"-1.5\"},{\"1\":\"10\",\"2\":\"2.0\",\"3\":\"4.0\",\"4\":\"-2.0\"},{\"1\":\"11\",\"2\":\"6.8\",\"3\":\"9.1\",\"4\":\"-2.3\"},{\"1\":\"12\",\"2\":\"8.5\",\"3\":\"20.9\",\"4\":\"-12.4\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\\normalsize\n\n## t-test on the differences\n- then throw them into t.test, testing that the mean is zero, with\nsame result as before:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(pain, t.test(diff, mu=0))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne Sample t-test\n\ndata:  diff\nt = -2.1677, df = 11, p-value = 0.05299\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n -4.29941513  0.03274847\nsample estimates:\nmean of x \n-2.133333 \n```\n\n\n:::\n:::\n",
    "supporting": [
      "inference_c33_files/figure-revealjs"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"inference_c33_files/libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"inference_c33_files/libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}