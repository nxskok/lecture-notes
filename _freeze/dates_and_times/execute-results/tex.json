{
  "hash": "9eeca9efbb52064c876b116ed96afd54",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Dates and Times\"\n---\n\n\n\n\n\n## Packages for this section\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n# library(lubridate)\n```\n:::\n\n\n\n\n`lubridate` is the package that handles dates and times, but is now part of the `tidyverse`, so no need to load separately.\n\n## Dates\n- Dates represented on computers as “days since an origin”,\ntypically Jan 1, 1970, with a negative date being before the origin: \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmydates <- c(\"1970-01-01\", \"2007-09-04\", \"1931-08-05\")\n(somedates <- tibble(text = mydates) %>%\n  mutate(\n    d = as.Date(text),\n    numbers = as.numeric(d)\n  ))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 3\n  text       d          numbers\n  <chr>      <date>       <dbl>\n1 1970-01-01 1970-01-01       0\n2 2007-09-04 2007-09-04   13760\n3 1931-08-05 1931-08-05  -14029\n```\n\n\n:::\n:::\n\n\n\n\n## Doing arithmetic with dates\n\n- Dates are \"actually\" numbers, so can add and subtract (difference is 2007 date in `d` minus others): \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsomedates %>% mutate(plus30 = d + 30, diffs = d[2] - d)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 5\n  text       d          numbers plus30     diffs     \n  <chr>      <date>       <dbl> <date>     <drtn>    \n1 1970-01-01 1970-01-01       0 1970-01-31 13760 days\n2 2007-09-04 2007-09-04   13760 2007-10-04     0 days\n3 1931-08-05 1931-08-05  -14029 1931-09-04 27789 days\n```\n\n\n:::\n:::\n\n\n\n\n## Reading in dates from a file\n- `read_csv` and the others can guess that you have dates, if you\nformat them as year-month-day, like column 1 of this `.csv`:\n\n```\ndate,status,dunno\n2011-08-03,hello,August 3 2011\n2011-11-15,still here,November 15 2011\n2012-02-01,goodbye,February 1 2012\n```\n\n- Then read them in:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/mydates.csv\"\nddd <- read_csv(my_url)\n```\n:::\n\n\n\n\n- read_csv guessed that the 1st column is dates, but not 3rd.\n\n## The data as read in\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nddd\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 3\n  date       status     dunno           \n  <date>     <chr>      <chr>           \n1 2011-08-03 hello      August 3 2011   \n2 2011-11-15 still here November 15 2011\n3 2012-02-01 goodbye    February 1 2012 \n```\n\n\n:::\n:::\n\n\n\n\n## Dates in other formats \n\n- Preceding shows that dates should be stored as text in format\nyyyy-mm-dd (ISO standard).\n- To deal with dates in other formats, use package `lubridate` and\nconvert. For example, dates in US format with month first:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(usdates = c(\"05/27/2012\", \"01/03/2016\", \"12/31/2015\")) %>%\n  mutate(iso = mdy(usdates))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 2\n  usdates    iso       \n  <chr>      <date>    \n1 05/27/2012 2012-05-27\n2 01/03/2016 2016-01-03\n3 12/31/2015 2015-12-31\n```\n\n\n:::\n:::\n\n\n\n\n## Trying to read these as UK dates \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(usdates = c(\"05/27/2012\", \"01/03/2016\", \"12/31/2015\")) %>%\n  mutate(uk = dmy(usdates))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 2\n  usdates    uk        \n  <chr>      <date>    \n1 05/27/2012 NA        \n2 01/03/2016 2016-03-01\n3 12/31/2015 NA        \n```\n\n\n:::\n:::\n\n\n\n\n- For UK-format dates with month second, one of these dates is legit,\nbut the other two make no sense.\n\n## Our data frame's last column:\n\n- Back to this: \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nddd\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 3\n  date       status     dunno           \n  <date>     <chr>      <chr>           \n1 2011-08-03 hello      August 3 2011   \n2 2011-11-15 still here November 15 2011\n3 2012-02-01 goodbye    February 1 2012 \n```\n\n\n:::\n:::\n\n\n\n\n- Month, day,  year in that order.\n\n## so interpret as such\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(ddd %>% mutate(date2 = mdy(dunno)) -> d4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 4\n  date       status     dunno            date2     \n  <date>     <chr>      <chr>            <date>    \n1 2011-08-03 hello      August 3 2011    2011-08-03\n2 2011-11-15 still here November 15 2011 2011-11-15\n3 2012-02-01 goodbye    February 1 2012  2012-02-01\n```\n\n\n:::\n:::\n\n\n\n\n\n## Are they really the same? \n\n- Column `date2` was correctly converted from column `dunno`: \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd4 %>% mutate(equal = identical(date, date2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 5\n  date       status     dunno            date2      equal\n  <date>     <chr>      <chr>            <date>     <lgl>\n1 2011-08-03 hello      August 3 2011    2011-08-03 TRUE \n2 2011-11-15 still here November 15 2011 2011-11-15 TRUE \n3 2012-02-01 goodbye    February 1 2012  2012-02-01 TRUE \n```\n\n\n:::\n:::\n\n\n\n\n- The two columns of dates are all the same.\n\n## Making dates from pieces\nStarting from this file:\n\n```\nyear month day\n1970 1 1\n2007 9 4\n1940 4 15\n```\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/pieces.txt\"\ndates0 <- read_delim(my_url, \" \")\n```\n:::\n\n\n\n\n## Making some dates \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndates0\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 3\n   year month   day\n  <dbl> <dbl> <dbl>\n1  1970     1     1\n2  2007     9     4\n3  1940     4    15\n```\n\n\n:::\n\n```{.r .cell-code}\ndates0 %>%\n  unite(dates, day, month, year) %>%\n  mutate(d = dmy(dates)) -> newdates\n```\n:::\n\n\n\n\n\n## The results\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnewdates\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 2\n  dates     d         \n  <chr>     <date>    \n1 1_1_1970  1970-01-01\n2 4_9_2007  2007-09-04\n3 15_4_1940 1940-04-15\n```\n\n\n:::\n:::\n\n\n\n\n- `unite` glues things together with an underscore between them (if you\ndon’t specify anything else). Syntax: first thing is new column to be\ncreated, other columns are what to make it out of.\n- `unite` makes the original variable columns year, month, day\n*disappear*.\n- The column `dates` is text, while `d` is a real date.\n\n## Extracting information from dates \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnewdates %>%\n  mutate(\n    mon = month(d),\n    day = day(d),\n    weekday = wday(d, label = TRUE)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 5\n  dates     d            mon   day weekday\n  <chr>     <date>     <dbl> <int> <ord>  \n1 1_1_1970  1970-01-01     1     1 Thu    \n2 4_9_2007  2007-09-04     9     4 Tue    \n3 15_4_1940 1940-04-15     4    15 Mon    \n```\n\n\n:::\n:::\n\n\n\n\n## Dates and times\n- Standard format for times is to put the time after the date, hours,\nminutes, seconds:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(dd <- tibble(text = c(\n  \"1970-01-01 07:50:01\", \"2007-09-04 15:30:00\",\n  \"1940-04-15 06:45:10\", \"2016-02-10 12:26:40\"\n)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 x 1\n  text               \n  <chr>              \n1 1970-01-01 07:50:01\n2 2007-09-04 15:30:00\n3 1940-04-15 06:45:10\n4 2016-02-10 12:26:40\n```\n\n\n:::\n:::\n\n\n\n\n## Converting text to date-times: \n\n- Then get from this text using `ymd_hms`:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndd %>% mutate(dt = ymd_hms(text)) %>% pull(dt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"1970-01-01 07:50:01 UTC\" \"2007-09-04 15:30:00 UTC\"\n[3] \"1940-04-15 06:45:10 UTC\" \"2016-02-10 12:26:40 UTC\"\n```\n\n\n:::\n:::\n\n\n\n\n\n## Timezones\n\n- Default timezone is “Universal Coordinated Time”. Change it via `tz=`\nand the name of a timezone: \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nOlsonNames()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [1] \"Africa/Abidjan\"                 \"Africa/Accra\"                  \n  [3] \"Africa/Addis_Ababa\"             \"Africa/Algiers\"                \n  [5] \"Africa/Asmara\"                  \"Africa/Bamako\"                 \n  [7] \"Africa/Bangui\"                  \"Africa/Banjul\"                 \n  [9] \"Africa/Bissau\"                  \"Africa/Blantyre\"               \n [11] \"Africa/Brazzaville\"             \"Africa/Bujumbura\"              \n [13] \"Africa/Cairo\"                   \"Africa/Casablanca\"             \n [15] \"Africa/Ceuta\"                   \"Africa/Conakry\"                \n [17] \"Africa/Dakar\"                   \"Africa/Dar_es_Salaam\"          \n [19] \"Africa/Djibouti\"                \"Africa/Douala\"                 \n [21] \"Africa/El_Aaiun\"                \"Africa/Freetown\"               \n [23] \"Africa/Gaborone\"                \"Africa/Harare\"                 \n [25] \"Africa/Johannesburg\"            \"Africa/Juba\"                   \n [27] \"Africa/Kampala\"                 \"Africa/Khartoum\"               \n [29] \"Africa/Kigali\"                  \"Africa/Kinshasa\"               \n [31] \"Africa/Lagos\"                   \"Africa/Libreville\"             \n [33] \"Africa/Lome\"                    \"Africa/Luanda\"                 \n [35] \"Africa/Lubumbashi\"              \"Africa/Lusaka\"                 \n [37] \"Africa/Malabo\"                  \"Africa/Maputo\"                 \n [39] \"Africa/Maseru\"                  \"Africa/Mbabane\"                \n [41] \"Africa/Mogadishu\"               \"Africa/Monrovia\"               \n [43] \"Africa/Nairobi\"                 \"Africa/Ndjamena\"               \n [45] \"Africa/Niamey\"                  \"Africa/Nouakchott\"             \n [47] \"Africa/Ouagadougou\"             \"Africa/Porto-Novo\"             \n [49] \"Africa/Sao_Tome\"                \"Africa/Timbuktu\"               \n [51] \"Africa/Tripoli\"                 \"Africa/Tunis\"                  \n [53] \"Africa/Windhoek\"                \"America/Adak\"                  \n [55] \"America/Anchorage\"              \"America/Anguilla\"              \n [57] \"America/Antigua\"                \"America/Araguaina\"             \n [59] \"America/Argentina/Buenos_Aires\" \"America/Argentina/Catamarca\"   \n [61] \"America/Argentina/Cordoba\"      \"America/Argentina/Jujuy\"       \n [63] \"America/Argentina/La_Rioja\"     \"America/Argentina/Mendoza\"     \n [65] \"America/Argentina/Rio_Gallegos\" \"America/Argentina/Salta\"       \n [67] \"America/Argentina/San_Juan\"     \"America/Argentina/San_Luis\"    \n [69] \"America/Argentina/Tucuman\"      \"America/Argentina/Ushuaia\"     \n [71] \"America/Aruba\"                  \"America/Asuncion\"              \n [73] \"America/Atikokan\"               \"America/Atka\"                  \n [75] \"America/Bahia\"                  \"America/Bahia_Banderas\"        \n [77] \"America/Barbados\"               \"America/Belem\"                 \n [79] \"America/Belize\"                 \"America/Blanc-Sablon\"          \n [81] \"America/Boa_Vista\"              \"America/Bogota\"                \n [83] \"America/Boise\"                  \"America/Cambridge_Bay\"         \n [85] \"America/Campo_Grande\"           \"America/Cancun\"                \n [87] \"America/Caracas\"                \"America/Cayenne\"               \n [89] \"America/Cayman\"                 \"America/Chicago\"               \n [91] \"America/Chihuahua\"              \"America/Ciudad_Juarez\"         \n [93] \"America/Coral_Harbour\"          \"America/Costa_Rica\"            \n [95] \"America/Coyhaique\"              \"America/Creston\"               \n [97] \"America/Cuiaba\"                 \"America/Curacao\"               \n [99] \"America/Danmarkshavn\"           \"America/Dawson\"                \n[101] \"America/Dawson_Creek\"           \"America/Denver\"                \n[103] \"America/Detroit\"                \"America/Dominica\"              \n[105] \"America/Edmonton\"               \"America/Eirunepe\"              \n[107] \"America/El_Salvador\"            \"America/Ensenada\"              \n[109] \"America/Fort_Nelson\"            \"America/Fortaleza\"             \n[111] \"America/Glace_Bay\"              \"America/Goose_Bay\"             \n[113] \"America/Grand_Turk\"             \"America/Grenada\"               \n[115] \"America/Guadeloupe\"             \"America/Guatemala\"             \n[117] \"America/Guayaquil\"              \"America/Guyana\"                \n[119] \"America/Halifax\"                \"America/Havana\"                \n[121] \"America/Hermosillo\"             \"America/Indiana/Indianapolis\"  \n[123] \"America/Indiana/Knox\"           \"America/Indiana/Marengo\"       \n[125] \"America/Indiana/Petersburg\"     \"America/Indiana/Tell_City\"     \n[127] \"America/Indiana/Vevay\"          \"America/Indiana/Vincennes\"     \n[129] \"America/Indiana/Winamac\"        \"America/Inuvik\"                \n[131] \"America/Iqaluit\"                \"America/Jamaica\"               \n[133] \"America/Juneau\"                 \"America/Kentucky/Louisville\"   \n[135] \"America/Kentucky/Monticello\"    \"America/Kralendijk\"            \n[137] \"America/La_Paz\"                 \"America/Lima\"                  \n[139] \"America/Los_Angeles\"            \"America/Lower_Princes\"         \n[141] \"America/Maceio\"                 \"America/Managua\"               \n[143] \"America/Manaus\"                 \"America/Marigot\"               \n[145] \"America/Martinique\"             \"America/Matamoros\"             \n[147] \"America/Mazatlan\"               \"America/Menominee\"             \n[149] \"America/Merida\"                 \"America/Metlakatla\"            \n[151] \"America/Mexico_City\"            \"America/Miquelon\"              \n[153] \"America/Moncton\"                \"America/Monterrey\"             \n[155] \"America/Montevideo\"             \"America/Montreal\"              \n[157] \"America/Montserrat\"             \"America/Nassau\"                \n[159] \"America/New_York\"               \"America/Nipigon\"               \n[161] \"America/Nome\"                   \"America/Noronha\"               \n[163] \"America/North_Dakota/Beulah\"    \"America/North_Dakota/Center\"   \n[165] \"America/North_Dakota/New_Salem\" \"America/Nuuk\"                  \n[167] \"America/Ojinaga\"                \"America/Panama\"                \n[169] \"America/Pangnirtung\"            \"America/Paramaribo\"            \n[171] \"America/Phoenix\"                \"America/Port_of_Spain\"         \n[173] \"America/Port-au-Prince\"         \"America/Porto_Acre\"            \n[175] \"America/Porto_Velho\"            \"America/Puerto_Rico\"           \n[177] \"America/Punta_Arenas\"           \"America/Rainy_River\"           \n[179] \"America/Rankin_Inlet\"           \"America/Recife\"                \n[181] \"America/Regina\"                 \"America/Resolute\"              \n[183] \"America/Rio_Branco\"             \"America/Santa_Isabel\"          \n[185] \"America/Santarem\"               \"America/Santiago\"              \n[187] \"America/Santo_Domingo\"          \"America/Sao_Paulo\"             \n[189] \"America/Scoresbysund\"           \"America/Shiprock\"              \n[191] \"America/Sitka\"                  \"America/St_Barthelemy\"         \n[193] \"America/St_Johns\"               \"America/St_Kitts\"              \n[195] \"America/St_Lucia\"               \"America/St_Thomas\"             \n[197] \"America/St_Vincent\"             \"America/Swift_Current\"         \n[199] \"America/Tegucigalpa\"            \"America/Thule\"                 \n[201] \"America/Thunder_Bay\"            \"America/Tijuana\"               \n[203] \"America/Toronto\"                \"America/Tortola\"               \n[205] \"America/Vancouver\"              \"America/Virgin\"                \n[207] \"America/Whitehorse\"             \"America/Winnipeg\"              \n[209] \"America/Yakutat\"                \"America/Yellowknife\"           \n[211] \"Antarctica/Casey\"               \"Antarctica/Davis\"              \n[213] \"Antarctica/DumontDUrville\"      \"Antarctica/Macquarie\"          \n[215] \"Antarctica/Mawson\"              \"Antarctica/McMurdo\"            \n[217] \"Antarctica/Palmer\"              \"Antarctica/Rothera\"            \n[219] \"Antarctica/Syowa\"               \"Antarctica/Troll\"              \n[221] \"Antarctica/Vostok\"              \"Arctic/Longyearbyen\"           \n[223] \"Asia/Aden\"                      \"Asia/Almaty\"                   \n[225] \"Asia/Amman\"                     \"Asia/Anadyr\"                   \n[227] \"Asia/Aqtau\"                     \"Asia/Aqtobe\"                   \n[229] \"Asia/Ashgabat\"                  \"Asia/Atyrau\"                   \n[231] \"Asia/Baghdad\"                   \"Asia/Bahrain\"                  \n[233] \"Asia/Baku\"                      \"Asia/Bangkok\"                  \n[235] \"Asia/Barnaul\"                   \"Asia/Beirut\"                   \n[237] \"Asia/Bishkek\"                   \"Asia/Brunei\"                   \n[239] \"Asia/Chita\"                     \"Asia/Choibalsan\"               \n[241] \"Asia/Chongqing\"                 \"Asia/Colombo\"                  \n[243] \"Asia/Damascus\"                  \"Asia/Dhaka\"                    \n[245] \"Asia/Dili\"                      \"Asia/Dubai\"                    \n[247] \"Asia/Dushanbe\"                  \"Asia/Famagusta\"                \n[249] \"Asia/Gaza\"                      \"Asia/Harbin\"                   \n[251] \"Asia/Hebron\"                    \"Asia/Ho_Chi_Minh\"              \n[253] \"Asia/Hong_Kong\"                 \"Asia/Hovd\"                     \n[255] \"Asia/Irkutsk\"                   \"Asia/Istanbul\"                 \n[257] \"Asia/Jakarta\"                   \"Asia/Jayapura\"                 \n[259] \"Asia/Jerusalem\"                 \"Asia/Kabul\"                    \n[261] \"Asia/Kamchatka\"                 \"Asia/Karachi\"                  \n[263] \"Asia/Kashgar\"                   \"Asia/Kathmandu\"                \n[265] \"Asia/Khandyga\"                  \"Asia/Kolkata\"                  \n[267] \"Asia/Krasnoyarsk\"               \"Asia/Kuala_Lumpur\"             \n[269] \"Asia/Kuching\"                   \"Asia/Kuwait\"                   \n[271] \"Asia/Macau\"                     \"Asia/Magadan\"                  \n[273] \"Asia/Makassar\"                  \"Asia/Manila\"                   \n[275] \"Asia/Muscat\"                    \"Asia/Nicosia\"                  \n[277] \"Asia/Novokuznetsk\"              \"Asia/Novosibirsk\"              \n[279] \"Asia/Omsk\"                      \"Asia/Oral\"                     \n[281] \"Asia/Phnom_Penh\"                \"Asia/Pontianak\"                \n[283] \"Asia/Pyongyang\"                 \"Asia/Qatar\"                    \n[285] \"Asia/Qostanay\"                  \"Asia/Qyzylorda\"                \n[287] \"Asia/Riyadh\"                    \"Asia/Sakhalin\"                 \n[289] \"Asia/Samarkand\"                 \"Asia/Seoul\"                    \n[291] \"Asia/Shanghai\"                  \"Asia/Singapore\"                \n[293] \"Asia/Srednekolymsk\"             \"Asia/Taipei\"                   \n[295] \"Asia/Tashkent\"                  \"Asia/Tbilisi\"                  \n[297] \"Asia/Tehran\"                    \"Asia/Tel_Aviv\"                 \n[299] \"Asia/Thimphu\"                   \"Asia/Tokyo\"                    \n[301] \"Asia/Tomsk\"                     \"Asia/Ulaanbaatar\"              \n[303] \"Asia/Urumqi\"                    \"Asia/Ust-Nera\"                 \n[305] \"Asia/Vientiane\"                 \"Asia/Vladivostok\"              \n[307] \"Asia/Yakutsk\"                   \"Asia/Yangon\"                   \n[309] \"Asia/Yekaterinburg\"             \"Asia/Yerevan\"                  \n[311] \"Atlantic/Azores\"                \"Atlantic/Bermuda\"              \n[313] \"Atlantic/Canary\"                \"Atlantic/Cape_Verde\"           \n[315] \"Atlantic/Faroe\"                 \"Atlantic/Jan_Mayen\"            \n[317] \"Atlantic/Madeira\"               \"Atlantic/Reykjavik\"            \n[319] \"Atlantic/South_Georgia\"         \"Atlantic/St_Helena\"            \n[321] \"Atlantic/Stanley\"               \"Australia/Adelaide\"            \n[323] \"Australia/Brisbane\"             \"Australia/Broken_Hill\"         \n[325] \"Australia/Canberra\"             \"Australia/Currie\"              \n[327] \"Australia/Darwin\"               \"Australia/Eucla\"               \n[329] \"Australia/Hobart\"               \"Australia/Lindeman\"            \n[331] \"Australia/Lord_Howe\"            \"Australia/Melbourne\"           \n[333] \"Australia/Perth\"                \"Australia/Sydney\"              \n[335] \"Australia/Yancowinna\"           \"CET\"                           \n[337] \"CST6CDT\"                        \"EET\"                           \n[339] \"EST\"                            \"EST5EDT\"                       \n[341] \"Etc/GMT\"                        \"Etc/GMT-0\"                     \n[343] \"Etc/GMT-1\"                      \"Etc/GMT-10\"                    \n[345] \"Etc/GMT-11\"                     \"Etc/GMT-12\"                    \n[347] \"Etc/GMT-13\"                     \"Etc/GMT-14\"                    \n[349] \"Etc/GMT-2\"                      \"Etc/GMT-3\"                     \n[351] \"Etc/GMT-4\"                      \"Etc/GMT-5\"                     \n[353] \"Etc/GMT-6\"                      \"Etc/GMT-7\"                     \n[355] \"Etc/GMT-8\"                      \"Etc/GMT-9\"                     \n[357] \"Etc/GMT+0\"                      \"Etc/GMT+1\"                     \n[359] \"Etc/GMT+10\"                     \"Etc/GMT+11\"                    \n[361] \"Etc/GMT+12\"                     \"Etc/GMT+2\"                     \n[363] \"Etc/GMT+3\"                      \"Etc/GMT+4\"                     \n[365] \"Etc/GMT+5\"                      \"Etc/GMT+6\"                     \n[367] \"Etc/GMT+7\"                      \"Etc/GMT+8\"                     \n[369] \"Etc/GMT+9\"                      \"Etc/GMT0\"                      \n[371] \"Etc/Greenwich\"                  \"Etc/UCT\"                       \n[373] \"Etc/Universal\"                  \"Etc/UTC\"                       \n[375] \"Etc/Zulu\"                       \"Europe/Amsterdam\"              \n[377] \"Europe/Andorra\"                 \"Europe/Astrakhan\"              \n[379] \"Europe/Athens\"                  \"Europe/Belfast\"                \n[381] \"Europe/Belgrade\"                \"Europe/Berlin\"                 \n[383] \"Europe/Bratislava\"              \"Europe/Brussels\"               \n[385] \"Europe/Bucharest\"               \"Europe/Budapest\"               \n[387] \"Europe/Busingen\"                \"Europe/Chisinau\"               \n[389] \"Europe/Copenhagen\"              \"Europe/Dublin\"                 \n[391] \"Europe/Gibraltar\"               \"Europe/Guernsey\"               \n[393] \"Europe/Helsinki\"                \"Europe/Isle_of_Man\"            \n[395] \"Europe/Istanbul\"                \"Europe/Jersey\"                 \n[397] \"Europe/Kaliningrad\"             \"Europe/Kirov\"                  \n[399] \"Europe/Kyiv\"                    \"Europe/Lisbon\"                 \n[401] \"Europe/Ljubljana\"               \"Europe/London\"                 \n[403] \"Europe/Luxembourg\"              \"Europe/Madrid\"                 \n[405] \"Europe/Malta\"                   \"Europe/Mariehamn\"              \n[407] \"Europe/Minsk\"                   \"Europe/Monaco\"                 \n[409] \"Europe/Moscow\"                  \"Europe/Nicosia\"                \n[411] \"Europe/Oslo\"                    \"Europe/Paris\"                  \n[413] \"Europe/Podgorica\"               \"Europe/Prague\"                 \n[415] \"Europe/Riga\"                    \"Europe/Rome\"                   \n[417] \"Europe/Samara\"                  \"Europe/San_Marino\"             \n[419] \"Europe/Sarajevo\"                \"Europe/Saratov\"                \n[421] \"Europe/Simferopol\"              \"Europe/Skopje\"                 \n[423] \"Europe/Sofia\"                   \"Europe/Stockholm\"              \n[425] \"Europe/Tallinn\"                 \"Europe/Tirane\"                 \n[427] \"Europe/Tiraspol\"                \"Europe/Ulyanovsk\"              \n[429] \"Europe/Vaduz\"                   \"Europe/Vatican\"                \n[431] \"Europe/Vienna\"                  \"Europe/Vilnius\"                \n[433] \"Europe/Volgograd\"               \"Europe/Warsaw\"                 \n[435] \"Europe/Zagreb\"                  \"Europe/Zurich\"                 \n[437] \"Factory\"                        \"GMT\"                           \n[439] \"HST\"                            \"Indian/Antananarivo\"           \n[441] \"Indian/Chagos\"                  \"Indian/Christmas\"              \n[443] \"Indian/Cocos\"                   \"Indian/Comoro\"                 \n[445] \"Indian/Kerguelen\"               \"Indian/Mahe\"                   \n[447] \"Indian/Maldives\"                \"Indian/Mauritius\"              \n[449] \"Indian/Mayotte\"                 \"Indian/Reunion\"                \n[451] \"MET\"                            \"MST\"                           \n[453] \"MST7MDT\"                        \"Pacific/Apia\"                  \n[455] \"Pacific/Auckland\"               \"Pacific/Bougainville\"          \n[457] \"Pacific/Chatham\"                \"Pacific/Chuuk\"                 \n[459] \"Pacific/Easter\"                 \"Pacific/Efate\"                 \n[461] \"Pacific/Fakaofo\"                \"Pacific/Fiji\"                  \n[463] \"Pacific/Funafuti\"               \"Pacific/Galapagos\"             \n[465] \"Pacific/Gambier\"                \"Pacific/Guadalcanal\"           \n[467] \"Pacific/Guam\"                   \"Pacific/Honolulu\"              \n[469] \"Pacific/Johnston\"               \"Pacific/Kanton\"                \n[471] \"Pacific/Kiritimati\"             \"Pacific/Kosrae\"                \n[473] \"Pacific/Kwajalein\"              \"Pacific/Majuro\"                \n[475] \"Pacific/Marquesas\"              \"Pacific/Midway\"                \n[477] \"Pacific/Nauru\"                  \"Pacific/Niue\"                  \n[479] \"Pacific/Norfolk\"                \"Pacific/Noumea\"                \n[481] \"Pacific/Pago_Pago\"              \"Pacific/Palau\"                 \n[483] \"Pacific/Pitcairn\"               \"Pacific/Pohnpei\"               \n[485] \"Pacific/Port_Moresby\"           \"Pacific/Rarotonga\"             \n[487] \"Pacific/Saipan\"                 \"Pacific/Samoa\"                 \n[489] \"Pacific/Tahiti\"                 \"Pacific/Tarawa\"                \n[491] \"Pacific/Tongatapu\"              \"Pacific/Wake\"                  \n[493] \"Pacific/Wallis\"                 \"Pacific/Yap\"                   \n[495] \"PST8PDT\"                        \"UTC\"                           \n[497] \"WET\"                           \nattr(,\"Version\")\n[1] \"2025b\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndd %>% \n  mutate(dt = ymd_hms(text, tz = \"America/Toronto\")) -> dd\ndd %>% mutate(zone = tz(dt))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 x 3\n  text                dt                  zone           \n  <chr>               <dttm>              <chr>          \n1 1970-01-01 07:50:01 1970-01-01 07:50:01 America/Toronto\n2 2007-09-04 15:30:00 2007-09-04 15:30:00 America/Toronto\n3 1940-04-15 06:45:10 1940-04-15 06:45:10 America/Toronto\n4 2016-02-10 12:26:40 2016-02-10 12:26:40 America/Toronto\n```\n\n\n:::\n:::\n\n\n\n\n## Extracting time parts\n- As you would expect: \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndd %>%\n  select(-text) %>%\n  mutate(\n    h = hour(dt),\n    sec = second(dt),\n    min = minute(dt),\n    zone = tz(dt)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 x 5\n  dt                      h   sec   min zone           \n  <dttm>              <int> <dbl> <int> <chr>          \n1 1970-01-01 07:50:01     7     1    50 America/Toronto\n2 2007-09-04 15:30:00    15     0    30 America/Toronto\n3 1940-04-15 06:45:10     6    10    45 America/Toronto\n4 2016-02-10 12:26:40    12    40    26 America/Toronto\n```\n\n\n:::\n:::\n\n\n\n\n## Same times, but different time zone: \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndd %>%\n  select(dt) %>%\n  mutate(oz = with_tz(dt, \"Australia/Sydney\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 x 2\n  dt                  oz                 \n  <dttm>              <dttm>             \n1 1970-01-01 07:50:01 1970-01-01 22:50:01\n2 2007-09-04 15:30:00 2007-09-05 05:30:00\n3 1940-04-15 06:45:10 1940-04-15 21:45:10\n4 2016-02-10 12:26:40 2016-02-11 04:26:40\n```\n\n\n:::\n:::\n\n\n\n\nIn more detail: \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndd %>%\n  mutate(oz = with_tz(dt, \"Australia/Sydney\")) %>%\n  pull(oz)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"1970-01-01 22:50:01 AEST\" \"2007-09-05 05:30:00 AEST\"\n[3] \"1940-04-15 21:45:10 AEST\" \"2016-02-11 04:26:40 AEDT\"\n```\n\n\n:::\n:::\n\n\n\n\n## How long between date-times?\n- We may need to calculate the time between two events. For example,\nthese are the dates and times that some patients were admitted to\nand discharged from a hospital:\n\n```\nadmit,discharge\n1981-12-10 22:00:00,1982-01-03 14:00:00\n2014-03-07 14:00:00,2014-03-08 09:30:00\n2016-08-31 21:00:00,2016-09-02 17:00:00\n```\n\n## Do they get read in as date-times? \n\n- These ought to get read in and converted to date-times:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/hospital.csv\"\nstays <- read_csv(my_url)\nstays\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 2\n  admit               discharge          \n  <dttm>              <dttm>             \n1 1981-12-10 22:00:00 1982-01-03 14:00:00\n2 2014-03-07 14:00:00 2014-03-08 09:30:00\n3 2016-08-31 21:00:00 2016-09-02 17:00:00\n```\n\n\n:::\n:::\n\n\n\n\n-  and so it proves.\n\n## Subtracting the date-times\n\n- In the obvious way, this gets us an answer:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstays %>% mutate(stay = discharge - admit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 3\n  admit               discharge           stay       \n  <dttm>              <dttm>              <drtn>     \n1 1981-12-10 22:00:00 1982-01-03 14:00:00 568.0 hours\n2 2014-03-07 14:00:00 2014-03-08 09:30:00  19.5 hours\n3 2016-08-31 21:00:00 2016-09-02 17:00:00  44.0 hours\n```\n\n\n:::\n:::\n\n\n\n\n- Number of hours; hard to interpret. \n\n## Days\n\n- Fractional number of days would\nbe better: \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstays %>% \n  mutate(\n    stay_days = as.period(admit %--% discharge) / days(1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 3\n  admit               discharge           stay_days\n  <dttm>              <dttm>                  <dbl>\n1 1981-12-10 22:00:00 1982-01-03 14:00:00    23.7  \n2 2014-03-07 14:00:00 2014-03-08 09:30:00     0.812\n3 2016-08-31 21:00:00 2016-09-02 17:00:00     1.83 \n```\n\n\n:::\n:::\n\n\n\n\n## Completed days\n\n- Pull out with `day()` etc, as for a date-time:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstays %>% \n  mutate(\n    stay = as.period(admit %--% discharge),\n    stay_days = day(stay),\n    stay_hours = hour(stay)\n    ) %>%\n  select(starts_with(\"stay\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 3\n  stay          stay_days stay_hours\n  <Period>          <dbl>      <dbl>\n1 23d 16H 0M 0S        23         16\n2 19H 30M 0S            0         19\n3 1d 20H 0M 0S          1         20\n```\n\n\n:::\n:::\n\n\n\n\n\n## Comments\n- Date-times are stored internally as seconds-since-something, so that\nsubtracting two of them will give, internally, a number of seconds.\n- Just subtracting the date-times is displayed as a time (in units that R\nchooses for us).\n- Convert to fractional times via a \"period\", then divide by `days(1)`, `months(1)` etc.\n- These ideas useful for calculating time from a start point until an event\nhappens (in this case, a patient being discharged from hospital).\n\n",
    "supporting": [
      "dates_and_times_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}