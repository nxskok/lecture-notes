{
  "hash": "0a8e221ec386fa189cd2fd7386351cd8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Normal quantile plots\"\n---\n\n\n\n\n## The normal quantile plot\n\n-   see that normal distributions of data (or being normal enough)\n    important\n-   only tools we have to assess this are histograms and maybe boxplots\n-   a better tool is **normal quantile plot**:\n    -   plot data against what you expect if data actually normal\n    -   look for points to follow a straight line, at least approx\n-   `ggplot` code: `aes` `sample`; geoms `stat_qq` and `stat_qq_line`\n\n## Packages\n\nThe usual:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\n\n## Kids learning to read\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 44\nColumns: 2\n$ group <chr> \"t\", \"t\", \"t\", \"t\", \"t\", \"t\", \"t\", \"t\", \"t\", \"t\", \"t\", \"t\", \"t\",~\n$ score <dbl> 24, 61, 59, 46, 43, 44, 52, 43, 58, 67, 62, 57, 71, 49, 54, 43, ~\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(kids, aes(x = group, y = score)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](inference_4a_files/figure-beamer/inference-4a-R-2-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\nEach group looks more or less normal, or at least close to symmetric.\n\n## Get the groups separately\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkids %>% filter(group == \"t\") -> treatment\nkids %>% filter(group == \"c\") -> control\ntreatment\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 21 x 2\n   group score\n   <chr> <dbl>\n 1 t        24\n 2 t        61\n 3 t        59\n 4 t        46\n 5 t        43\n 6 t        44\n 7 t        52\n 8 t        43\n 9 t        58\n10 t        67\n# i 11 more rows\n```\n\n\n:::\n:::\n\n\n\n\nto check\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntreatment %>% count(group)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 x 2\n  group     n\n  <chr> <int>\n1 t        21\n```\n\n\n:::\n\n```{.r .cell-code}\ncontrol %>% count(group)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 x 2\n  group     n\n  <chr> <int>\n1 c        23\n```\n\n\n:::\n:::\n\n\n\n\n## The treatment group\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(treatment, aes(sample = score)) + \n  stat_qq() + stat_qq_line()\n```\n\n::: {.cell-output-display}\n![](inference_4a_files/figure-beamer/inference-4a-R-5-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\nonly problem here is lowest value a little too low (mild outlier).\n\n## Control group\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(control, aes(sample = score)) + \n  stat_qq() + stat_qq_line()\n```\n\n::: {.cell-output-display}\n![](inference_4a_files/figure-beamer/inference-4a-R-6-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\nThis time, highest value a little too high, but again, no real problem\nwith normality.\n\n## Facetting more than one sample\n\nUse the whole data set and facet by groups\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(kids, aes(sample = score)) + \n  stat_qq() + stat_qq_line() + facet_wrap(~group)\n```\n\n::: {.cell-output-display}\n![](inference_4a_files/figure-beamer/inference-4a-R-7-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## Blue Jays attendances, skewed to right\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(jays, aes(x = attendance)) + geom_histogram(bins = 6)\n```\n\n::: {.cell-output-display}\n![](inference_4a_files/figure-beamer/inference-4a-R-9-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## On a normal quantile plot\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(jays, aes(sample = attendance)) + \n  stat_qq() + stat_qq_line()\n```\n\n::: {.cell-output-display}\n![](inference_4a_files/figure-beamer/inference-4a-R-10-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n-   Attendances at low end too bunched up: skewed to right.\n-   Right-skewness can also show up as highest values being too high, or\n    as a curved pattern in the points.\n\n## More normal quantile plots\n\n-   How straight does a normal quantile plot have to be?\n-   There is randomness in real data, so even a normal quantile plot\n    from normal data won't look perfectly straight.\n-   With a small sample, can look not very straight even from normal\n    data.\n-   Looking for systematic departure from a straight line; random\n    wiggles ought not to concern us.\n-   Look at some examples where we know the answer, so that we can see\n    what to expect.\n\n## Normal data, large sample\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- tibble(x=rnorm(200))\nggplot(d, aes(x=x)) + geom_histogram(bins=10)\n```\n\n::: {.cell-output-display}\n![](inference_4a_files/figure-beamer/inference-4a-R-11-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## The normal quantile plot\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(d,aes(sample=x))+stat_qq()+stat_qq_line()\n```\n\n::: {.cell-output-display}\n![](inference_4a_files/figure-beamer/inference-4a-R-12-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## Normal data, small sample\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n-   Not so convincingly normal, but not obviously skewed:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- tibble(x=rnorm(20))\nggplot(d, aes(x=x)) + geom_histogram(bins=5)\n```\n\n::: {.cell-output-display}\n![](inference_4a_files/figure-beamer/normal-small-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## The normal quantile plot\n\nGood, apart from the highest and lowest points being slightly off. I'd\ncall this good:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(d, aes(sample=x)) + stat_qq() + stat_qq_line()\n```\n\n::: {.cell-output-display}\n![](inference_4a_files/figure-beamer/inference-4a-R-14-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## Chi-squared data, *df* = 10\n\nSomewhat skewed to right:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- tibble(x=rchisq(100, 10))\nggplot(d,aes(x=x)) + geom_histogram(bins=10)\n```\n\n::: {.cell-output-display}\n![](inference_4a_files/figure-beamer/inference-4a-R-15-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## The normal quantile plot\n\nSomewhat opening-up curve:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(d,aes(sample=x))+stat_qq()+stat_qq_line()\n```\n\n::: {.cell-output-display}\n![](inference_4a_files/figure-beamer/inference-4a-R-16-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## Chi-squared data, df = 3\n\nDefinitely skewed to right:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- tibble(x=rchisq(100, 3))\nggplot(d, aes(x=x)) + geom_histogram(bins=10)\n```\n\n::: {.cell-output-display}\n![](inference_4a_files/figure-beamer/chisq-small-df-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## The normal quantile plot\n\nClear upward-opening curve:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(d,aes(sample=x))+stat_qq()+stat_qq_line()\n```\n\n::: {.cell-output-display}\n![](inference_4a_files/figure-beamer/inference-4a-R-17-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## t-distributed data, df = 3\n\nLong tails (or a very sharp peak):\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- tibble(x=rt(300, 3))\nggplot(d, aes(x=x)) + geom_histogram(bins=15)\n```\n\n::: {.cell-output-display}\n![](inference_4a_files/figure-beamer/t-small-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## The normal quantile plot\n\nLow values too low and high values too high for normal.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(d,aes(sample=x))+stat_qq()+stat_qq_line()\n```\n\n::: {.cell-output-display}\n![](inference_4a_files/figure-beamer/inference-4a-R-18-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## Summary\n\nOn a normal quantile plot:\n\n-   points following line (with some small wiggles): normal.\n-   kind of deviation from a straight line indicates kind of\n    nonnormality:\n    -   a few highest point(s) too high and/or lowest too low: outliers\n    -   else see how points at each end off the line:\n\n|                | High points |              |\n|----------------|-------------|--------------|\n| **Low points** | **Too low** | **Too high** |\n| **Too low**    | Skewed left | Long tails   |\n| **Too high**   | Short tails | Skewed right |\n\n-   short-tailed distribution OK for $t$ (mean still good), but others\n    problematic (depending on sample size).\n",
    "supporting": [
      "inference_4a_files/figure-beamer"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}