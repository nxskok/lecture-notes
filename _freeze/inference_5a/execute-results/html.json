{
  "hash": "6c2a926116eee233fa696b49763a31ad",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Mood's Median Test\"\neditor: \n  markdown: \n    wrap: 72\n---\n\n\n\n\n## Packages\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(smmr)\n```\n:::\n\n\n\n\n## Two-sample test: What to do if normality fails\n\n-   If normality fails (for one or both of the groups), what do we do\n    then?\n-   Again, can compare medians: use the thought process of the sign\n    test, which does not depend on normality and is not damaged by\n    outliers.\n-   A suitable test called Mood's median test.\n-   Before we get to that, a diversion.\n\n## The chi-squared test for independence\n\nSuppose we want to know whether people are in favour of having daylight\nsavings time all year round. We ask 20 males and 20 females whether they\neach agree with having DST all year round (\"yes\") or not (\"no\"). Some\nrandomly chosen data:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/dst.txt\"\ndst <- read_delim(my_url,\" \")\ndst %>% slice_sample(n = 10)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"gender\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"agree\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"female\",\"2\":\"no\"},{\"1\":\"male\",\"2\":\"yes\"},{\"1\":\"female\",\"2\":\"yes\"},{\"1\":\"male\",\"2\":\"yes\"},{\"1\":\"female\",\"2\":\"yes\"},{\"1\":\"male\",\"2\":\"yes\"},{\"1\":\"male\",\"2\":\"yes\"},{\"1\":\"female\",\"2\":\"yes\"},{\"1\":\"female\",\"2\":\"yes\"},{\"1\":\"male\",\"2\":\"yes\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n## ... continued\n\nCount up individuals in each category combination, and arrange in\ncontingency table:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab <- with(dst, table(gender, agree))\ntab\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        agree\ngender   no yes\n  female 11   9\n  male    3  17\n```\n\n\n:::\n:::\n\n\n\n\n-   Most of the males say \"yes\", but the females are about evenly split.\n-   Looks like males more likely to say \"yes\", ie. an association\n    between gender and agreement.\n-   Test an $H_0$ of \"no association\" (\"independence\") vs. alternative\n    that there is really some association.\n-   Done with `chisq.test`.\n\n## ...And finally\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(tab, correct=FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  tab\nX-squared = 7.033, df = 1, p-value = 0.008002\n```\n\n\n:::\n:::\n\n\n\n\n-   Reject null hypothesis of no association (P-value 0.008)\n-   therefore there is a difference in rates of agreement between (all)\n    males and females (or that gender and agreement are associated).\n-   This calculation gives same answers as you would get by hand.\n    (Omitting `correct = FALSE` uses \"Yates correction\".\n\n## Mood's median test\n\n-   Earlier: compare medians of two groups.\n-   Sign test: count number of values above and below something (there,\n    hypothesized median).\n-   Mood's median test:\n    -   Find \"grand median\" of all the data, regardless of group\n    -   Count data values in each group above/below grand median.\n    -   Make contingency table of group vs. above/below.\n    -   Test for association.\n-   If group medians equal, each group should have about half its\n    observations above/below grand median. If not, one group will be\n    mostly above grand median and other below.\n\n## Mood's median test for reading data\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"group\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"score\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"t\",\"2\":\"24\"},{\"1\":\"t\",\"2\":\"61\"},{\"1\":\"t\",\"2\":\"59\"},{\"1\":\"t\",\"2\":\"46\"},{\"1\":\"t\",\"2\":\"43\"},{\"1\":\"t\",\"2\":\"44\"},{\"1\":\"t\",\"2\":\"52\"},{\"1\":\"t\",\"2\":\"43\"},{\"1\":\"t\",\"2\":\"58\"},{\"1\":\"t\",\"2\":\"67\"},{\"1\":\"t\",\"2\":\"62\"},{\"1\":\"t\",\"2\":\"57\"},{\"1\":\"t\",\"2\":\"71\"},{\"1\":\"t\",\"2\":\"49\"},{\"1\":\"t\",\"2\":\"54\"},{\"1\":\"t\",\"2\":\"43\"},{\"1\":\"t\",\"2\":\"53\"},{\"1\":\"t\",\"2\":\"57\"},{\"1\":\"t\",\"2\":\"49\"},{\"1\":\"t\",\"2\":\"56\"},{\"1\":\"t\",\"2\":\"33\"},{\"1\":\"c\",\"2\":\"42\"},{\"1\":\"c\",\"2\":\"33\"},{\"1\":\"c\",\"2\":\"46\"},{\"1\":\"c\",\"2\":\"37\"},{\"1\":\"c\",\"2\":\"43\"},{\"1\":\"c\",\"2\":\"41\"},{\"1\":\"c\",\"2\":\"10\"},{\"1\":\"c\",\"2\":\"42\"},{\"1\":\"c\",\"2\":\"55\"},{\"1\":\"c\",\"2\":\"19\"},{\"1\":\"c\",\"2\":\"17\"},{\"1\":\"c\",\"2\":\"55\"},{\"1\":\"c\",\"2\":\"26\"},{\"1\":\"c\",\"2\":\"54\"},{\"1\":\"c\",\"2\":\"60\"},{\"1\":\"c\",\"2\":\"28\"},{\"1\":\"c\",\"2\":\"62\"},{\"1\":\"c\",\"2\":\"20\"},{\"1\":\"c\",\"2\":\"53\"},{\"1\":\"c\",\"2\":\"48\"},{\"1\":\"c\",\"2\":\"37\"},{\"1\":\"c\",\"2\":\"85\"},{\"1\":\"c\",\"2\":\"42\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n-   Find overall median score:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkids %>% summarize(med=median(score)) %>% pull(med) -> m\nm\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 47\n```\n\n\n:::\n:::\n\n\n\n\n-   Make table of above/below vs. group:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab <- with(kids, table(group, score > m))\ntab\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     \ngroup FALSE TRUE\n    c    15    8\n    t     7   14\n```\n\n\n:::\n:::\n\n\n\n\n-   Treatment group scores mostly above median, control group scores\n    mostly below, as expected.\n\n## The test\n\n-   Do chi-squared test:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(tab, correct=FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  tab\nX-squared = 4.4638, df = 1, p-value = 0.03462\n```\n\n\n:::\n:::\n\n\n\n\n-   This test actually two-sided (tests for any association).\n-   Here want to test that new reading method *better* (one-sided).\n-   Most of treatment children above overall median, so do 1-sided test\n    by halving P-value to get 0.017.\n-   This way too, children do better at learning to read using the new\n    method.\n\n## Or by smmr\n\n-   `median_test` does the whole thing:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedian_test(kids, score, group)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$grand_median\n[1] 47\n\n$table\n     above\ngroup above below\n    c     8    15\n    t    14     7\n\n$test\n       what      value\n1 statistic 4.46376812\n2        df 1.00000000\n3   P-value 0.03462105\n```\n\n\n:::\n:::\n\n\n\n\n-   P-value again two-sided.\n\n## Comments\n\n-   P-value 0.013 for (1-sided) t-test, 0.017 for (1-sided) Mood median\n    test.\n-   Like the sign test, Mood's median test doesn't use the data very\n    efficiently (only, is each value above or below grand median).\n-   Thus, if we can justify doing *t*-test, we should do it. This is the\n    case here.\n-   The *t*-test will usually give smaller P-value because it uses the\n    data more efficiently.\n-   The time to use Mood's median test is if we are definitely unhappy\n    with the normality assumption (and thus the t-test P-value is not to\n    be trusted).\n\n## A graph\n\n- Two categorical variables (above/below and group), so grouped bar chart\n- `group` is \"explanatory\" and above/below is \"response\".\n- Plot explanatory as `x` and plot response as `fill` (`y` will be frequency):\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkids %>% \n  mutate(above = (score > m)) %>% \n  ggplot(aes(x = group, fill = above)) + geom_bar(position = \"dodge\") -> g\n```\n:::\n\n\n\n\n## The graph\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng\n```\n\n::: {.cell-output-display}\n![](inference_5a_files/figure-revealjs/unnamed-chunk-3-1.png){width=960}\n:::\n:::\n\n\n\n\n- The significant association is because the treatment group children mostly score above the grand median, and the control group children score mostly below.\n\n",
    "supporting": [
      "inference_5a_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"inference_5a_files/libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"inference_5a_files/libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}